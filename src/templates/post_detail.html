{% extends "base.html" %}
{% load urlify %}
{% load crispy_forms_tags %}
{% load crispy_forms_field %}

{% block head_title %}
    {{instance.title}} | {{block.super}}
{% endblock head_title %}

<!-- /*<style>
    {% block style %}
        h1{
            color: #777777;
        }
    {% endblock style%}
</style>*/ -->

{% block content %}
<div class="col-sm-6 col-sm-offset-3">
    {% if instance.image %}
        <img src="{{instance.image.url}}" alt="" class="img-responsive">
    {% endif %}
    <h1>
        {{title}} <small>{% if instance.draft %}<span style="color:red">Draft </span>
            {% endif %}{{instance.publish}}</small>
    </h1>
    <p>
        {% if instance.user.get_full_name %}
            Author: {{instance.user.get_full_name}}
        {% else %}
            Author: {{instance.user}}
        {% endif %}
    </p>

    <p>

        <div class="fb-like" data-href={{request.build_absolute_uri}}
        data-layout="standard" data-action="like" data-size="small"
        data-show-faces="true" data-share="true"></div>

    </p>
    <!-- {{share_string}} <br /> -->
    <!-- {{instance.content |truncatechars:80| urlify}}<br /> -->
    <p>
        <a href="https://www.facebook.com/sharer/sharer.php?u={{request.build_absolute_uri}}">
        Facebook
        </a>

        <a href="https://twitter.com/home?status={{instance.content |truncatechars:80| urlify}}%20{{request.build_absolute_uri}}">
        Twitter
        </a>

        <a href='https://plus.google.com/share?url={{request.build_absolute_uri}}'>Google-Plus</a>

        <a href="https://www.linkedin.com/shareArticle?mini=true&url={{request.build_absolute_uri}}
        &title={{instance.title}}&summary={{share_string}}&source={{request.build_absolute_uri}}">
        Linkedin
        </a>

        <a href="http://www.reddit.com/submit?url={{request.build_absolute_uri}}
        &title={{share_string}}.">Reddit</a>
    </p>

    <hr />
    <div class="row">
        <div class="col-sm-12">
            <div class="post-detail-item img">{{instance.get_markdown}}</div>
        <br />
        <hr />
        <!-- {{instance.comments.all}} -->
        <div class="">
            <!-- {{instance.comment_set.all}} -->
            <p class="lead">Comments</p>
            <form class="" action="." method="post"> {% csrf_token %}
                {{comment_form |crispy}}
                <input type="submit" name="" value="Post Comment" class="btn btn-default">

            </form>
            <hr />
            {% for comment in comments %}

                <blockquote>
                    <p>{{comment.content}}</p>
                    <footer>
                        via {{comment.user}} | {{comment.timestamp|timesince}} ago |
                        {% if comment.children.count > 0 %}
                         {{comment.children.count}} Comment{%if comment.children.count > 1 %}s {% endif %}
                        |{% endif %}
                        <a class="comment-reply-btn" href="#">Reply</a> |
                        <a href="{{comment.get_absolute_url}}">Thread</a>
                    </footer>
                    <div class="comment-reply" style="display:none;">
                        {% for comment_child in comment.children %}
                        <blockquote>
                        <p>{{comment_child.content}}</p>
                        <footer>via {{comment_child.user}} | {{comment_child.timestamp|timesince}} ago</footer>
                        </blockquote>
                        {% endfor %}

                        <form class="" action="." method="post"> {% csrf_token %}
                            {{comment_form |crispy}}
                            <input type="hidden" name="parent_id" value="{{comment.id}}">
                            <input type="submit" name="" value="Reply" class="btn btn-default">
                        </form>
                    </div>
                </blockquote>
                <hr />
            {% endfor%}
        <!-- </div>
    <div class="row">
        <div class="col-sm-12" "col-sm-offset-2">
            <div class="fb-comments" data-href={{request.build_absolute_uri}} data-numposts="5"></div>
        </div> -->
        </div>


    <!-- {{request.build_absolute_uri}} -->



</div>
{% endblock content %}
